<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-Strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport"
		content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes" />
	<link href="#{request.contextPath}/css/style.css" rel="stylesheet"
		type="text/css" />
	<title>朝阳工商分局</title>
</h:head>
<h:body>
	<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
		closable="false" resizable="false" showHeader="false">
		<h1 id="note">正在处理，请稍候......</h1>
		<img src="#{request.contextPath}/images/ajaxloadingbar.gif" />
	</p:dialog>

	<h:form id="formone">
		<p:dialog visible="#{not empty facesContext.messageList}"
			header="#{facesContext.messageList[0].severity eq 'ERROR 2'?'错误':' '}"
			modal="true">
			<p:repeat value="#{facesContext.messageList}" var="message">
				<h:panelGrid columns="2" style="width:100%"
					columnClasses="logo,detail">
					<p:graphicImage rendered="#{message.severity eq 'INFO 0'}"
						url="/images/info.png" />
					<p:graphicImage rendered="#{message.severity eq 'WARN 1'}"
						url="/images/warn.png" />
					<p:graphicImage rendered="#{message.severity eq 'ERROR 2'}"
						url="/images/error.png" />
					<h:outputText value="#{message.detail}" style="font-weight: bold" />
				</h:panelGrid>
			</p:repeat>
		</p:dialog>

		<div align="center">
			<p:panelGrid id="panel" style="margin-top:0px; width:100%">
				<f:facet name="header">
					<p:outputLabel value="微信投诉登记表" style="font-weight: bold;" />
				</f:facet>
				<p:row>
					<p:column style="width:25%;">
						<p:outputLabel value="投诉编号" />
					</p:column>
					<p:column colspan="4" style="width:75%;">
						<p:outputLabel value="#{eventBean.creg.eventno}" />
					</p:column>
				</p:row>
				<p:row>
					<p:column rowspan="3" style="width:25%;">
    		投诉人
    	</p:column>
					<p:column style="width:15%;">
						<p:outputLabel value="名称" />
					</p:column>
					<p:column colspan="3" style="width:60%;">
						<p:inputText id="Eventhand_custname"
							value="#{eventBean.creg.custname}" style="width:95%">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputText>
						<p:watermark for="Eventhand_custname" value="必填项" />
						<p:message for="Eventhand_custname" />

					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:15%;">
						<p:outputLabel value="地址" />
					</p:column>
					<p:column colspan="3" style="width:60%;">
						<p:inputText id="Eventhand_custplace"
							value="#{eventBean.creg.custplace}" style="width:95%">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputText>
						<p:message for="Eventhand_custplace" />
					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:15%;">
						<p:outputLabel value="手机号码" />
					</p:column>
					<p:column colspan="3" style="width:60%;">
						<p:inputText id="Eventhand_custtele"
							value="#{eventBean.creg.custtele}" style="width:95%">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputText>
						<p:watermark for="Eventhand_custtele" value="必填项" />
						<p:message for="Eventhand_custtele" />
					</p:column>
				</p:row>
				<p:row>
					<p:column rowspan="3" style="width:25%;">
    		被投诉人
    	</p:column>
					<p:column style="width:15%;">
						<p:outputLabel value="名称" />
					</p:column>
					<p:column colspan="3" style="width:60%;">
						<p:inputText id="Eventhand_eventtarget"
							value="#{eventBean.creg.eventtarget}" style="width:95%">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputText>
						<p:watermark for="Eventhand_eventtarget" value="必填项" />
						<p:message for="Eventhand_eventtarget" />
					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:15%;">
						<p:outputLabel value="地址" />
					</p:column>
					<p:column colspan="3" style="width:60%;">
						<p:inputText id="Eventhand_eventplace"
							value="#{eventBean.creg.eventplace}" style="width:95%">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputText>
						<p:watermark for="Eventhand_eventplace" value="必填项" />
						<p:message for="Eventhand_eventplace" />
					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:15%;">
						<p:outputLabel value="联系方式" />
					</p:column>
					<p:column colspan="3" style="width:60%;">
						<p:inputText id="Eventhand_eventtele"
							value="#{eventBean.creg.eventtele}" style="width:95%">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputText>
						<p:message for="Eventhand_eventtele" />
					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:25%;">
    		投诉内容
    	</p:column>
					<p:column colspan="4" style="width:75%;">
						<p:inputTextarea id="Eventhand_eventdetail" rows="5"
							style="width:96%" value="#{eventBean.creg.eventdetail}"
							counter="detail_remain" maxlength="500"
							counterTemplate="还可输入{0}字 ." autoResize="false">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputTextarea>
						<br />
						<h:outputText id="detail_remain" />
						<p:watermark for="Eventhand_eventdetail" value="必填项" />
						<p:message for="Eventhand_eventdetail" />
					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:15%;">
    		消费者<br />诉求
    	</p:column>
					<p:column colspan="4" style="width:75%;">
						<p:inputTextarea id="Eventhand_eventrequest" rows="5"
							style="width:96%" value="#{eventBean.creg.eventrequest}"
							counter="request_remain" maxlength="500"
							counterTemplate="还可输入{0}字 ." autoResize="false">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:inputTextarea>
						<br />
						<h:outputText id="request_remain" />
						<p:watermark for="Eventhand_eventrequest" value="必填项" />
						<p:message for="Eventhand_eventrequest" />
					</p:column>
				</p:row>
				<p:row>
					<p:column style="width:15%;">
    		消费日期
    	</p:column>
					<p:column colspan="4" style="width:75%;">
						<p:calendar locale="zh_CN" id="Eventhand_eventtime"
							value="#{eventBean.creg.eventtime}" pattern="yyyy/MM/dd HH:mm:ss"
							navigator="true" readonlyInput="false" yearRange="c-20:c+20">
							<f:converter converterId="gov.cygs.ConValidator" />
						</p:calendar>
					</p:column>
				</p:row>
				<p:row>
					<p:column colspan="5" style="width:100%;">
						<div align="center" class="center">
							<p:outputPanel id="buttons" style="padding-top:20px;">
								<p:commandButton update="formone" process="@this"
									style="text-align:center; margin:0 auto;"
									actionListener="#{eventBean.reset('creg')}" immediate="true"
									ajax="false" value="清空">
									<p:resetInput target="panel" />
								</p:commandButton>
								<p:commandButton style="text-align:center; margin:0 auto;"
									action="#{eventBean.saveData('creg')}" value="提交"
									update="formone" oncomplete="PF('welcome').show; ">
								</p:commandButton>
							</p:outputPanel>
						</div>
					</p:column>
				</p:row>
			</p:panelGrid>
			<p>选择上传图片，最多5张：</p>
			<p:fileUpload style="width:90%"
				fileUploadListener="#{eventBean.handleFileUploadA}" mode="advanced"
				dragDropSupport="false" update="uploads" label="上传图片"
				uploadLabel="上传" cancelLabel="取消" sizeLimit="8000000" auto="true"
				skinSimple="true" fileLimit="5" allowTypes="/(\.|\/)(jpg)$/">
			</p:fileUpload>

			<p:dataTable emptyMessage="无记录" style="font:12px;" id="uploads"
				var="upfile" value="#{eventBean.creg.upfiles}" paginator="false"
				rows="20" selection="#{eventBean.selectUpfile}"
				rowKey="#{upfile.uuid}" selectionMode="single">
				<p:ajax event="rowSelect" listener="#{eventBean.onFileSelect}"
					update="formone" />
				<p:column style="width:80%" headerText="图片">
					<p:graphicImage
						url="../userspace/uploads/weixinpho/#{upfile.uuid}.jpg"
						width="340" height="480" />
					<br />
					<h:outputText value="#{upfile.remark}" />
				</p:column>
				<p:column style="width:10%" headerText="">
					<p:commandLink process="uploads" update="formone" value="X"
						action="#{eventBean.deleteUpfile()}">
						<f:setPropertyActionListener value="#{upfile}"
							target="#{eventBean.selectUpfile}" />
					</p:commandLink>
				</p:column>
			</p:dataTable>
		</div>

		<p:dialog visible="#{eventBean.showWelcome}" showHeader="false"
			widgetVar="welcome" modal="true">
			<table border="0">
				<tr align="center">
					<td><img src="#{request.contextPath}/images/weixiao.png" /></td>
					<td>
						<p style="font-size: 16px; font-weight: 900;">您的投诉提交成功！</p>
						<p style="font-size: 16px; font-weight: 900;">请牢记生成的投诉编号</p>

					</td>
				</tr>
				<tr align="center">
					<td colspan="2"><p:commandButton value="确定" immediate="true"
							onclick="PF('welcome').hide();" /></td>
				</tr>
			</table>
		</p:dialog>



	</h:form>

</h:body>
</html>

